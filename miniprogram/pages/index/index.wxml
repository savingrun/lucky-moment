<t-message id="t-message" />
<t-toast id="t-toast">
    <view style="padding-top: 32rpx;" slot="message">
        <text>{{dynamicMessages}}</text>
    </view>
</t-toast>
<t-toast id="t-toast-warning" />

<view wx:if="{{uploadCloudFlag}}">
    <t-fab icon="cloud-upload" bind:click="uploadCloud" aria-label="增加" custom-style="z-index: 100; position: absolute; right: 32rpx; bottom: 64rpx;"></t-fab>
</view>

<view wx:if="{{rolePoolDataFlag}}">
    <t-cell-group theme="card">
        <view>
            <!-- <t-icon name="cloud" size="24" data-name="cloud" /> -->
            <text style="font-size: 36rpx; font-weight: 800; line-height: 64rpx; color: rgba(0, 0, 0, 0.9)">云端数据</text>
        </view>
        <view class="section_content">
            <t-skeleton theme="paragraph" animation="gradient" loading="{{skeletonLoading}}"></t-skeleton>
        </view>
        <block wx:for="{{requestRecordList}}" wx:key="keyId" wx:for-index="index" wx:for-item="requestRecord">
            <t-cell bind:click="getHistoryRecord" data-uid="{{requestRecord.uid}}" leftIcon="cloud-download" hover custom-style="border-radius: 18rpx; margin: 18rpx 0 18rpx 0;">
                <text slot="title" style="font-size: 28rpx; font-weight: 700;">{{requestRecord.uid}}</text>
                <text slot="note" style="font-size: 28rpx; font-weight: 700;">{{requestRecord.create_time}}</text>
            </t-cell>
        </block>
    </t-cell-group>
    <view class="textarea">
        <t-textarea t-class-label="t-class-label" bind:change="contentUrl" t-class="external-class" label="URL" placeholder="https://hk4e-api.mihoyo.com/event/gacha_info/api/getGachaLog?.." maxlength="2000" indicator disableDefaultPadding="{{true}}" style="border-radius: 18rpx;" />
    </view>
</view>
<view wx:else>
    <t-divider content="{{ uid ? uid : '数据展示' }}" />
    <!-- <scroll-view scroll-y="true" style="max-height: {{scrollViewHeight}}rpx;" enable-back-to-top="true" scroll-anchoring="true" enable-passive="true" enhanced="true" fast-deceleration="true"> -->
        <view class="textarea">
            <t-tabs defaultValue="{{0}}" bind:change="onTabsChange" bind:click="onTabsClick" t-class="custom-tabs" theme="card" custom-style="border-radius: 18rpx;">
                <t-tab-panel label="角色池" value="0" style="{{tabPanelstyle}}">
                    <view wx:if="{{rolePoolDataFlag}}">暂无数据</view>
                    <view wx:else>
                        <view>
                            <t-steps layout="vertical" readonly theme="default">
                                <block wx:for="{{analyseRolePoolList}}" wx:key="keyId" wx:for-index="index" wx:for-item="record">
                                    <t-step-item status="{{record.info.item_type==null ? 'default' : 'finish'}}" icon="round" title="{{record.info.item_type==null ? '已垫' : record.info.item_type + ' | '}}{{record.info.name}} | {{record.flagNum}} 抽">
                                        <view style="margin-top: 32rpx;" slot="content">
                                            <t-progress theme="plump" label="{{false}}" percentage="{{(record.flagNum/90)*100}}" />
                                        </view>
                                    </t-step-item>
                                </block>
                            </t-steps>
                        </view>
                    </view>
                </t-tab-panel>
                <t-tab-panel label="武器池" value="1" style="{{tabPanelstyle}}">
                    <view wx:if="{{weaponPoolDataFlag}}">暂无数据</view>
                    <view wx:else>
                        <view>
                            <t-steps separator="arrow" layout="vertical" readonly theme="default">
                                <block wx:for="{{analyseWeaponPoolList}}" wx:key="keyId" wx:for-index="index" wx:for-item="record">
                                    <t-step-item status="{{record.info.item_type==null ? 'default' : 'finish'}}" icon="round" title="{{record.info.item_type==null ? '已垫' : record.info.item_type + ' | '}}{{record.info.name}} | {{record.flagNum}} 抽">
                                        <view style="margin-top: 32rpx;" slot="content">
                                            <t-progress theme="plump" label="{{false}}" percentage="{{(record.flagNum/90)*100}}" />
                                        </view>
                                    </t-step-item>
                                </block>
                            </t-steps>
                        </view>
                    </view>
                </t-tab-panel>
                <t-tab-panel label="常驻池" value="2" style="{{tabPanelstyle}}">
                    <view wx:if="{{permanentPoolDataFlag}}">暂无数据</view>
                    <view wx:else>
                        <view>
                            <t-steps layout="vertical" readonly theme="default">
                                <block wx:for="{{analysePermanentPoolList}}" wx:key="keyId" wx:for-index="index" wx:for-item="record">
                                    <t-step-item status="{{record.info.item_type==null ? 'default' : 'finish'}}" icon="round" title="{{record.info.item_type==null ? '已垫' : record.info.item_type + ' | '}}{{record.info.name}} | {{record.flagNum}} 抽">
                                        <view style="margin-top: 32rpx;" slot="content">
                                            <t-progress theme="plump" label="{{false}}" percentage="{{(record.flagNum/90)*100}}" />
                                        </view>
                                    </t-step-item>
                                </block>
                            </t-steps>
                        </view>
                    </view>
                </t-tab-panel>
            </t-tabs>
        </view>
    <!-- </scroll-view> -->
    <t-divider />
</view>

<view class="button" wx:if="{{snapButtonFlag}}">
    <t-button theme="primary" size="large" block bind:tap="snap">分析</t-button>
</view>
<view class="button" wx:else>
    <t-button theme="default" size="large" block bind:tap="clearData">返回</t-button>
</view>

<view class="t-footer">
    <t-footer theme="text" copyright="{{copyright}}"></t-footer>
</view>